{"ast":null,"code":"const classed = require('@compone/class'),\n      event = require('@compone/event'),\n      client = require('utilise/client'),\n      noop = () => {},\n      HTMLElement = client && window.HTMLElement || class {},\n      registry = client && window.customElements || {};\n\nmodule.exports = function define(name, component) {\n  if (arguments.length == 1) {\n    component = name, name = `anon-${registry.anon++}`;\n  }\n\n  if (component.hasOwnProperty('wrapper')) return component.wrapper;\n  if (!name.includes('-')) return;\n  if (!client) return wrap(classed(component));\n  let wrapped = registry.get(name);\n\n  if (wrapped) {\n    if (wrapped.class == classed(component)) return wrapped;\n    wrapped.class = classed(component);\n    const instances = Array.from(document.querySelectorAll(name));\n    instances.map(node => {\n      // TODO: should probably await these\n      node.disconnectedCallback();\n      node.methods.map(method => {\n        delete node[method];\n      });\n      node.connectedCallback();\n    });\n  } else {\n    registry.define(name, wrapped = wrap(classed(component)));\n  }\n\n  return wrapped;\n};\n\nconst wrap = component => {\n  if (!component.hasOwnProperty('wrapper')) component.wrapper = class extends HTMLElement {\n    constructor() {\n      super();\n      event(this);\n      this.ready = this.once('ready');\n      this.state = this.state || {};\n    }\n\n    connectedCallback() {\n      const {\n        prototype\n      } = component.wrapper.class;\n      this.methods = Object.getOwnPropertyNames(prototype).filter(method => !(method in disallowed)).map(method => (this[method] = prototype[method].bind(this), method));\n      return Promise.resolve((this.connected || noop).call(this, this, this.state)).then(d => {\n        this.emit('ready');\n        return this.render();\n      });\n    }\n\n    render() {\n      const {\n        prototype\n      } = component.wrapper.class;\n      return this.pending = this.pending || this.ready.then(() => {\n        delete this.pending;\n        return prototype.render.call(this, this, this.state);\n      });\n    }\n\n    disconnectedCallback() {\n      (this.disconnected || noop).call(this, this, this.state);\n      this.dispatchEvent(new CustomEvent('disconnected'));\n      this.initialised = false;\n    }\n\n    get(sel) {\n      return this.querySelector(sel);\n    }\n\n  };\n  component.wrapper.class = component;\n  return component.wrapper;\n};\n\nconst disallowed = {\n  length: 1,\n  prototype: 1,\n  name: 1,\n  render: 1\n};\nregistry.anon = registry.anon || 1;","map":{"version":3,"sources":["F:/Assessment/client/chat-app/node_modules/@compone/define/index.js"],"names":["classed","require","event","client","noop","HTMLElement","window","registry","customElements","module","exports","define","name","component","arguments","length","anon","hasOwnProperty","wrapper","includes","wrap","wrapped","get","class","instances","Array","from","document","querySelectorAll","map","node","disconnectedCallback","methods","method","connectedCallback","constructor","ready","once","state","prototype","Object","getOwnPropertyNames","filter","disallowed","bind","Promise","resolve","connected","call","then","d","emit","render","pending","disconnected","dispatchEvent","CustomEvent","initialised","sel","querySelector"],"mappings":"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","sourcesContent":["const classed = require('@compone/class')\r\n    , event = require('@compone/event')\r\n    , client = require('utilise/client')\r\n    , noop = () => {}\r\n    , HTMLElement = client && window.HTMLElement || class {}\r\n    , registry = client && window.customElements || {}\r\n\r\nmodule.exports = function define(name, component) {\r\n  if (arguments.length == 1) { component = name, name = `anon-${registry.anon++}` }\r\n  if (component.hasOwnProperty('wrapper')) return component.wrapper\r\n  if (!name.includes('-')) return;\r\n  if (!client) return wrap(classed(component))\r\n  let wrapped = registry.get(name)\r\n\r\n  if (wrapped) {\r\n    if (wrapped.class == classed(component)) return wrapped\r\n    wrapped.class = classed(component)\r\n    const instances = Array.from(document.querySelectorAll(name))\r\n    instances.map(node => { // TODO: should probably await these\r\n      node.disconnectedCallback() \r\n      node.methods.map(method => { delete node[method] })\r\n      node.connectedCallback()\r\n    })\r\n  } else {\r\n    registry.define(name, wrapped = wrap(classed(component)))\r\n  }\r\n\r\n  return wrapped\r\n}\r\n\r\nconst wrap = component => {\r\n  if (!component.hasOwnProperty('wrapper'))\r\n    component.wrapper = class extends HTMLElement {\r\n      constructor(){\r\n        super()\r\n        event(this)\r\n        this.ready = this.once('ready')\r\n        this.state = this.state || {}\r\n      }\r\n\r\n      connectedCallback(){ \r\n        const { prototype } = component.wrapper.class\r\n        this.methods = Object\r\n          .getOwnPropertyNames(prototype)\r\n          .filter(method => !(method in disallowed))\r\n          .map(method => ((this[method] = prototype[method].bind(this)), method))\r\n\r\n        return Promise.resolve((this.connected || noop).call(this, this, this.state))\r\n          .then(d => {\r\n            this.emit('ready')\r\n            return this.render()\r\n          })\r\n      }\r\n\r\n      render(){\r\n        const { prototype } = component.wrapper.class\r\n        return this.pending = this.pending || this.ready\r\n          .then(() => { \r\n            delete this.pending\r\n            return prototype.render.call(this, this, this.state)  \r\n          })\r\n      }\r\n\r\n      disconnectedCallback(){\r\n        (this.disconnected || noop).call(this, this, this.state)\r\n        this.dispatchEvent(new CustomEvent('disconnected')) \r\n        this.initialised = false\r\n      }\r\n\r\n      get(sel){\r\n        return this.querySelector(sel)\r\n      }\r\n    }\r\n\r\n  component.wrapper.class = component\r\n  return component.wrapper\r\n}\r\n\r\nconst disallowed = { length: 1, prototype: 1, name: 1, render: 1 }\r\n\r\nregistry.anon = registry.anon || 1"]},"metadata":{},"sourceType":"script"}